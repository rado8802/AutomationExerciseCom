using Microsoft.Playwright;
using System.Threading.Tasks;

namespace AutomationExerciseTests.Pages
{
    public class ProductsPage: BasePage
    {
        public ProductsPage(IPage page) : base(page) { }

        public ILocator SearchInput => Page.Locator("#search_product");
        public ILocator SearchButton => Page.GetByRole(AriaRole.Button, new() { Name = "Submit" });
        public ILocator ProductList => Page.Locator(".features_items");
        public ILocator SearchedHeader => Page.Locator("h2:has-text('Searched Products')");
        public ILocator AllProductsHeader => Page.Locator("h2:has-text('All Products')");

        public async Task OpenAsync()
        {
            await Page.GotoAsync("https://automationexercise.com/products");
        }

        public async Task SearchAsync(string productName)
        {
            await SearchInput.FillAsync(productName);
            await SearchButton.ClickAsync();
        }

        public async Task AddFirstProductToCartAsync()
        {
            await Page.Locator(".add-to-cart").First.ClickAsync();
        }

        public async Task OpenFirstProductDetailsAsync()
        {
            await Page.Locator(".choose a").First.ClickAsync();
        }
    }
}
